2024-11-20 17:26:30,601 - MainThread - sqlmesh.core.config.scheduler - WARNING - The snowflake engine is not recommended for storing SQLMesh state in production deployments. Please see https://sqlmesh.readthedocs.io/en/stable/guides/configuration/#state-connection for a list of recommended engines and more information. (scheduler.py:94)
2024-11-20 17:26:30,603 - MainThread - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.12.3, Platform: Linux-6.8.0-48-generic-x86_64-with-glibc2.39 (connection.py:414)
2024-11-20 17:26:30,603 - MainThread - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain (connection.py:1197)
2024-11-20 17:26:30,603 - MainThread - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity. (connection.py:1278)
2024-11-20 17:26:31,318 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 3 (cursor.py:1166)
2024-11-20 17:26:31,434 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:31,566 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:31,679 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:31,790 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 3 (cursor.py:1166)
2024-11-20 17:26:31,899 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:32,013 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:32,127 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:32,596 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 0 (cursor.py:1166)
2024-11-20 17:26:32,709 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:33,056 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 8 (cursor.py:1166)
2024-11-20 17:26:33,171 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:33,420 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 7 (cursor.py:1166)
2024-11-20 17:26:33,543 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:33,746 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:33,857 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:33,985 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:34,098 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:34,349 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 4 (cursor.py:1166)
2024-11-20 17:26:34,473 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:38,534 - ThreadPoolExecutor-8_0 - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema SQLMESH_DEMO.sqlmesh__SQL_MODELS (evaluator.py:282)
2024-11-20 17:26:38,535 - ThreadPoolExecutor-8_0 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.12.3, Platform: Linux-6.8.0-48-generic-x86_64-with-glibc2.39 (connection.py:414)
2024-11-20 17:26:38,535 - ThreadPoolExecutor-8_0 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain (connection.py:1197)
2024-11-20 17:26:38,535 - ThreadPoolExecutor-8_0 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity. (connection.py:1278)
2024-11-20 17:26:39,064 - ThreadPoolExecutor-8_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_DATABASE() (base.py:2062)
2024-11-20 17:26:39,186 - ThreadPoolExecutor-8_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:39,299 - ThreadPoolExecutor-8_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:39,300 - ThreadPoolExecutor-8_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_DATABASE() (base.py:2062)
2024-11-20 17:26:39,412 - ThreadPoolExecutor-8_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:39,521 - ThreadPoolExecutor-8_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:39,527 - ThreadPoolExecutor-8_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT DISTINCT "TABLE_CATALOG" AS "catalog", "TABLE_NAME" AS "name", "TABLE_SCHEMA" AS "schema_name", CASE WHEN "TABLE_TYPE" = 'BASE TABLE' AND "IS_DYNAMIC" = 'YES' THEN 'MANAGED_TABLE' WHEN "TABLE_TYPE" = 'BASE TABLE' THEN 'TABLE' WHEN "TABLE_TYPE" = 'TEMPORARY TABLE' THEN 'TABLE' WHEN "TABLE_TYPE" = 'LOCAL TEMPORARY' THEN 'TABLE' WHEN "TABLE_TYPE" = 'EXTERNAL TABLE' THEN 'TABLE' WHEN "TABLE_TYPE" = 'EVENT TABLE' THEN 'TABLE' WHEN "TABLE_TYPE" = 'VIEW' THEN 'VIEW' WHEN "TABLE_TYPE" = 'MATERIALIZED VIEW' THEN 'MATERIALIZED_VIEW' ELSE "TABLE_TYPE" END AS "type", "CLUSTERING_KEY" AS "clustering_key" FROM "SQLMESH_DEMO"."INFORMATION_SCHEMA"."TABLES" WHERE "TABLE_SCHEMA" = 'sqlmesh__SQL_MODELS' AND "TABLE_NAME" IN ('SQL_MODELS__VIEW_MODEL__2798581076', 'SQL_MODELS__PARTITION_INCREMENT_MODEL__1397460444', 'SQL_MODELS__EXTERNAL_MODEL__2639882224', 'SQL_MODELS__UNIQUE_KEY_INCREMENTAL_MODEL__166104753', 'SQL_MODELS__JINJA_MACRO__1453613019', 'SQL_MODELS__TIME_RANGE_INCREMENTAL_MODEL__66652497', 'SQL_MODELS__SEED_MODEL__4008025669', 'SQL_MODELS__FULL_MODEL__1482248485') (base.py:2062)
2024-11-20 17:26:40,140 - ThreadPoolExecutor-8_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 7 (cursor.py:1166)
2024-11-20 17:26:40,249 - ThreadPoolExecutor-8_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:40,259 - MainThread - snowflake.connector.connection - INFO - closed (connection.py:789)
2024-11-20 17:26:40,350 - MainThread - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session (connection.py:795)
2024-11-20 17:26:40,475 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'SQLMESH_DEMO.sqlmesh__SQL_MODELS' (evaluator.py:906)
2024-11-20 17:26:40,476 - MainThread - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.12.3, Platform: Linux-6.8.0-48-generic-x86_64-with-glibc2.39 (connection.py:414)
2024-11-20 17:26:40,477 - MainThread - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain (connection.py:1197)
2024-11-20 17:26:40,477 - MainThread - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity. (connection.py:1278)
2024-11-20 17:26:41,006 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "SQLMESH_DEMO"."sqlmesh__SQL_MODELS" (base.py:2062)
2024-11-20 17:26:41,119 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:41,229 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:41,230 - ThreadPoolExecutor-12_0 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.12.3, Platform: Linux-6.8.0-48-generic-x86_64-with-glibc2.39 (connection.py:414)
2024-11-20 17:26:41,231 - ThreadPoolExecutor-12_0 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain (connection.py:1197)
2024-11-20 17:26:41,231 - ThreadPoolExecutor-12_0 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity. (connection.py:1278)
2024-11-20 17:26:41,728 - ThreadPoolExecutor-12_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE TABLE "SQLMESH_DEMO"."sqlmesh__SQL_MODELS"."SQL_MODELS__JINJA_MACRO__1453613019" (base.py:2062)
2024-11-20 17:26:41,851 - ThreadPoolExecutor-12_0 - sqlmesh.core.snapshot.evaluator - INFO - Creating view 'SQLMESH_DEMO.sqlmesh__SQL_MODELS.SQL_MODELS__JINJA_MACRO__1453613019' (evaluator.py:1617)
2024-11-20 17:26:41,865 - ThreadPoolExecutor-12_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE VIEW "SQLMESH_DEMO"."sqlmesh__SQL_MODELS"."SQL_MODELS__JINJA_MACRO__1453613019" AS SELECT "EXTERNAL_MODEL"."INVOICE_ID" AS "INVOICE_ID" FROM "SQLMESH_DEMO"."sqlmesh__SQL_MODELS"."SQL_MODELS__EXTERNAL_MODEL__2639882224" AS "EXTERNAL_MODEL" (base.py:2062)
2024-11-20 17:26:42,084 - ThreadPoolExecutor-12_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:42,198 - ThreadPoolExecutor-12_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:42,200 - MainThread - snowflake.connector.connection - INFO - closed (connection.py:789)
2024-11-20 17:26:42,300 - MainThread - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session (connection.py:795)
2024-11-20 17:26:42,561 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 0 (cursor.py:1166)
2024-11-20 17:26:42,692 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:42,883 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:43,027 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:44,118 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:44,429 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 9 (cursor.py:1166)
2024-11-20 17:26:44,563 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:44,737 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:45,340 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:46,120 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:46,239 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:46,396 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 0 (cursor.py:1166)
2024-11-20 17:26:46,504 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:46,689 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 7 (cursor.py:1166)
2024-11-20 17:26:46,802 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:46,821 - ThreadPoolExecutor-22_0 - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"SQLMESH_DEMO"."SQL_MODELS"."JINJA_MACRO": 2863286735> (evaluator.py:508)
2024-11-20 17:26:46,822 - ThreadPoolExecutor-22_0 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.12.3, Platform: Linux-6.8.0-48-generic-x86_64-with-glibc2.39 (connection.py:414)
2024-11-20 17:26:46,822 - ThreadPoolExecutor-22_0 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain (connection.py:1197)
2024-11-20 17:26:46,822 - ThreadPoolExecutor-22_0 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity. (connection.py:1278)
2024-11-20 17:26:47,327 - ThreadPoolExecutor-22_0 - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2024-11-19 00:00:00+00:00, 2024-11-20 00:00:00+00:00) into SQLMESH_DEMO.sqlmesh__SQL_MODELS.SQL_MODELS__JINJA_MACRO__1453613019' (evaluator.py:538)
2024-11-20 17:26:47,328 - ThreadPoolExecutor-22_0 - sqlmesh.core.snapshot.evaluator - INFO - Replacing view 'SQLMESH_DEMO.sqlmesh__SQL_MODELS.SQL_MODELS__JINJA_MACRO__1453613019' (evaluator.py:1572)
2024-11-20 17:26:47,331 - ThreadPoolExecutor-22_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "SQLMESH_DEMO"."sqlmesh__SQL_MODELS"."SQL_MODELS__JINJA_MACRO__1453613019" ("INVOICE_ID") COPY GRANTS AS SELECT "EXTERNAL_MODEL"."INVOICE_ID" AS "INVOICE_ID" FROM "SQLMESH_DEMO"."sqlmesh__SQL_MODELS"."SQL_MODELS__EXTERNAL_MODEL__2639882224" AS "EXTERNAL_MODEL" (base.py:2062)
2024-11-20 17:26:47,541 - ThreadPoolExecutor-22_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:47,689 - ThreadPoolExecutor-22_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:47,692 - ThreadPoolExecutor-22_0 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.12.3, Platform: Linux-6.8.0-48-generic-x86_64-with-glibc2.39 (connection.py:414)
2024-11-20 17:26:47,692 - ThreadPoolExecutor-22_0 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain (connection.py:1197)
2024-11-20 17:26:47,693 - ThreadPoolExecutor-22_0 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity. (connection.py:1278)
2024-11-20 17:26:48,164 - ThreadPoolExecutor-22_0 - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (1731974400000, 1732060800000) for snapshot SnapshotId<"SQLMESH_DEMO"."SQL_MODELS"."JINJA_MACRO": 2863286735> (engine_adapter.py:933)
2024-11-20 17:26:48,289 - ThreadPoolExecutor-22_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:48,483 - ThreadPoolExecutor-22_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:48,621 - ThreadPoolExecutor-22_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:49,535 - ThreadPoolExecutor-22_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:49,822 - ThreadPoolExecutor-22_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10 (cursor.py:1166)
2024-11-20 17:26:49,948 - ThreadPoolExecutor-22_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:50,153 - ThreadPoolExecutor-22_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:50,746 - ThreadPoolExecutor-22_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:51,487 - ThreadPoolExecutor-22_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:51,600 - ThreadPoolExecutor-22_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:51,613 - MainThread - snowflake.connector.connection - INFO - closed (connection.py:789)
2024-11-20 17:26:51,712 - MainThread - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session (connection.py:795)
2024-11-20 17:26:51,817 - MainThread - snowflake.connector.connection - INFO - closed (connection.py:789)
2024-11-20 17:26:51,918 - MainThread - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session (connection.py:795)
2024-11-20 17:26:52,037 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Promoting environment 'prod' (engine_adapter.py:266)
2024-11-20 17:26:52,270 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 9 (cursor.py:1166)
2024-11-20 17:26:52,395 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:53,295 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:53,641 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:53,809 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:54,802 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:55,096 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 14 (cursor.py:1166)
2024-11-20 17:26:55,217 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:55,396 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:55,986 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:56,818 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:56,933 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:57,148 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 9 (cursor.py:1166)
2024-11-20 17:26:57,222 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Unpausing snapshot SnapshotId<"SQLMESH_DEMO"."SQL_MODELS"."JINJA_MACRO": 2863286735> (engine_adapter.py:435)
2024-11-20 17:26:58,002 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:58,006 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'SQLMESH_DEMO.SQL_MODELS' (evaluator.py:906)
2024-11-20 17:26:58,006 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "SQLMESH_DEMO"."SQL_MODELS" (base.py:2062)
2024-11-20 17:26:58,117 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:58,228 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:58,231 - ThreadPoolExecutor-39_1 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'SQLMESH_DEMO.SQL_MODELS.SEED_MODEL' to point at table 'SQLMESH_DEMO.sqlmesh__SQL_MODELS.SQL_MODELS__SEED_MODEL__4008025669' (evaluator.py:1162)
2024-11-20 17:26:58,232 - ThreadPoolExecutor-39_1 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.12.3, Platform: Linux-6.8.0-48-generic-x86_64-with-glibc2.39 (connection.py:414)
2024-11-20 17:26:58,232 - ThreadPoolExecutor-39_1 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain (connection.py:1197)
2024-11-20 17:26:58,232 - ThreadPoolExecutor-39_1 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity. (connection.py:1278)
2024-11-20 17:26:58,236 - ThreadPoolExecutor-39_2 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'SQLMESH_DEMO.SQL_MODELS.EXTERNAL_MODEL' to point at table 'SQLMESH_DEMO.sqlmesh__SQL_MODELS.SQL_MODELS__EXTERNAL_MODEL__2639882224' (evaluator.py:1162)
2024-11-20 17:26:58,788 - ThreadPoolExecutor-39_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "SQLMESH_DEMO"."SQL_MODELS"."SEED_MODEL" COPY GRANTS AS SELECT * FROM "SQLMESH_DEMO"."sqlmesh__SQL_MODELS"."SQL_MODELS__SEED_MODEL__4008025669" (base.py:2062)
2024-11-20 17:26:58,788 - ThreadPoolExecutor-39_2 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.12.3, Platform: Linux-6.8.0-48-generic-x86_64-with-glibc2.39 (connection.py:414)
2024-11-20 17:26:58,788 - ThreadPoolExecutor-39_2 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain (connection.py:1197)
2024-11-20 17:26:58,788 - ThreadPoolExecutor-39_2 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity. (connection.py:1278)
2024-11-20 17:26:59,361 - ThreadPoolExecutor-39_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "SQLMESH_DEMO"."SQL_MODELS"."EXTERNAL_MODEL" COPY GRANTS AS SELECT * FROM "SQLMESH_DEMO"."sqlmesh__SQL_MODELS"."SQL_MODELS__EXTERNAL_MODEL__2639882224" (base.py:2062)
2024-11-20 17:26:59,564 - ThreadPoolExecutor-39_1 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:59,654 - ThreadPoolExecutor-39_2 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:59,684 - ThreadPoolExecutor-39_1 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:59,689 - ThreadPoolExecutor-39_0 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'SQLMESH_DEMO.SQL_MODELS.PARTITION_INCREMENT_MODEL' to point at table 'SQLMESH_DEMO.sqlmesh__SQL_MODELS.SQL_MODELS__PARTITION_INCREMENT_MODEL__1397460444' (evaluator.py:1162)
2024-11-20 17:26:59,689 - ThreadPoolExecutor-39_3 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'SQLMESH_DEMO.SQL_MODELS.TIME_RANGE_INCREMENTAL_MODEL' to point at table 'SQLMESH_DEMO.sqlmesh__SQL_MODELS.SQL_MODELS__TIME_RANGE_INCREMENTAL_MODEL__66652497' (evaluator.py:1162)
2024-11-20 17:26:59,690 - ThreadPoolExecutor-39_0 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.12.3, Platform: Linux-6.8.0-48-generic-x86_64-with-glibc2.39 (connection.py:414)
2024-11-20 17:26:59,691 - ThreadPoolExecutor-39_1 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'SQLMESH_DEMO.SQL_MODELS.UNIQUE_KEY_INCREMENTAL_MODEL' to point at table 'SQLMESH_DEMO.sqlmesh__SQL_MODELS.SQL_MODELS__UNIQUE_KEY_INCREMENTAL_MODEL__166104753' (evaluator.py:1162)
2024-11-20 17:26:59,692 - ThreadPoolExecutor-39_0 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain (connection.py:1197)
2024-11-20 17:26:59,692 - ThreadPoolExecutor-39_0 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity. (connection.py:1278)
2024-11-20 17:26:59,776 - ThreadPoolExecutor-39_2 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:26:59,782 - ThreadPoolExecutor-39_2 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'SQLMESH_DEMO.SQL_MODELS.FULL_MODEL' to point at table 'SQLMESH_DEMO.sqlmesh__SQL_MODELS.SQL_MODELS__FULL_MODEL__1482248485' (evaluator.py:1162)
2024-11-20 17:27:00,206 - ThreadPoolExecutor-39_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "SQLMESH_DEMO"."SQL_MODELS"."PARTITION_INCREMENT_MODEL" COPY GRANTS AS SELECT * FROM "SQLMESH_DEMO"."sqlmesh__SQL_MODELS"."SQL_MODELS__PARTITION_INCREMENT_MODEL__1397460444" (base.py:2062)
2024-11-20 17:27:00,207 - ThreadPoolExecutor-39_3 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.12.3, Platform: Linux-6.8.0-48-generic-x86_64-with-glibc2.39 (connection.py:414)
2024-11-20 17:27:00,207 - ThreadPoolExecutor-39_3 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain (connection.py:1197)
2024-11-20 17:27:00,207 - ThreadPoolExecutor-39_3 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity. (connection.py:1278)
2024-11-20 17:27:00,695 - ThreadPoolExecutor-39_3 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "SQLMESH_DEMO"."SQL_MODELS"."TIME_RANGE_INCREMENTAL_MODEL" COPY GRANTS AS SELECT * FROM "SQLMESH_DEMO"."sqlmesh__SQL_MODELS"."SQL_MODELS__TIME_RANGE_INCREMENTAL_MODEL__66652497" (base.py:2062)
2024-11-20 17:27:00,697 - ThreadPoolExecutor-39_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "SQLMESH_DEMO"."SQL_MODELS"."UNIQUE_KEY_INCREMENTAL_MODEL" COPY GRANTS AS SELECT * FROM "SQLMESH_DEMO"."sqlmesh__SQL_MODELS"."SQL_MODELS__UNIQUE_KEY_INCREMENTAL_MODEL__166104753" (base.py:2062)
2024-11-20 17:27:00,699 - ThreadPoolExecutor-39_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "SQLMESH_DEMO"."SQL_MODELS"."FULL_MODEL" COPY GRANTS AS SELECT * FROM "SQLMESH_DEMO"."sqlmesh__SQL_MODELS"."SQL_MODELS__FULL_MODEL__1482248485" (base.py:2062)
2024-11-20 17:27:00,925 - ThreadPoolExecutor-39_2 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:27:00,943 - ThreadPoolExecutor-39_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:27:00,948 - ThreadPoolExecutor-39_1 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:27:00,953 - ThreadPoolExecutor-39_3 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:27:01,042 - ThreadPoolExecutor-39_2 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:27:01,046 - ThreadPoolExecutor-39_2 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'SQLMESH_DEMO.SQL_MODELS.JINJA_MACRO' to point at table 'SQLMESH_DEMO.sqlmesh__SQL_MODELS.SQL_MODELS__JINJA_MACRO__1453613019' (evaluator.py:1162)
2024-11-20 17:27:01,050 - ThreadPoolExecutor-39_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "SQLMESH_DEMO"."SQL_MODELS"."JINJA_MACRO" COPY GRANTS AS SELECT * FROM "SQLMESH_DEMO"."sqlmesh__SQL_MODELS"."SQL_MODELS__JINJA_MACRO__1453613019" (base.py:2062)
2024-11-20 17:27:01,063 - ThreadPoolExecutor-39_1 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:27:01,066 - ThreadPoolExecutor-39_1 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'SQLMESH_DEMO.SQL_MODELS.VIEW_MODEL' to point at table 'SQLMESH_DEMO.sqlmesh__SQL_MODELS.SQL_MODELS__VIEW_MODEL__2798581076' (evaluator.py:1162)
2024-11-20 17:27:01,067 - ThreadPoolExecutor-39_3 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:27:01,068 - ThreadPoolExecutor-39_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "SQLMESH_DEMO"."SQL_MODELS"."VIEW_MODEL" COPY GRANTS AS SELECT * FROM "SQLMESH_DEMO"."sqlmesh__SQL_MODELS"."SQL_MODELS__VIEW_MODEL__2798581076" (base.py:2062)
2024-11-20 17:27:01,070 - ThreadPoolExecutor-39_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:27:01,264 - ThreadPoolExecutor-39_2 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:27:01,280 - ThreadPoolExecutor-39_1 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:27:01,381 - ThreadPoolExecutor-39_2 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:27:01,399 - ThreadPoolExecutor-39_1 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:27:01,409 - MainThread - snowflake.connector.connection - INFO - closed (connection.py:789)
2024-11-20 17:27:01,513 - MainThread - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session (connection.py:795)
2024-11-20 17:27:01,621 - MainThread - snowflake.connector.connection - INFO - closed (connection.py:789)
2024-11-20 17:27:01,721 - MainThread - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session (connection.py:795)
2024-11-20 17:27:01,827 - MainThread - snowflake.connector.connection - INFO - closed (connection.py:789)
2024-11-20 17:27:01,934 - MainThread - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session (connection.py:795)
2024-11-20 17:27:02,038 - MainThread - snowflake.connector.connection - INFO - closed (connection.py:789)
2024-11-20 17:27:02,138 - MainThread - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session (connection.py:795)
2024-11-20 17:27:02,243 - ThreadPoolExecutor-40_0 - sqlmesh.core.snapshot.evaluator - INFO - Dropping view 'SQLMESH_DEMO.DOCS_EXAMPLE.SNOWPARK' (evaluator.py:1172)
2024-11-20 17:27:02,244 - ThreadPoolExecutor-40_0 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.12.3, Platform: Linux-6.8.0-48-generic-x86_64-with-glibc2.39 (connection.py:414)
2024-11-20 17:27:02,244 - ThreadPoolExecutor-40_0 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain (connection.py:1197)
2024-11-20 17:27:02,244 - ThreadPoolExecutor-40_0 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity. (connection.py:1278)
2024-11-20 17:27:02,245 - ThreadPoolExecutor-40_1 - sqlmesh.core.snapshot.evaluator - INFO - Dropping view 'SQLMESH_DEMO.SQLMESH_EXAMPLE.SEED_MODEL' (evaluator.py:1172)
2024-11-20 17:27:02,777 - ThreadPoolExecutor-40_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP VIEW IF EXISTS "SQLMESH_DEMO"."DOCS_EXAMPLE"."SNOWPARK" (base.py:2062)
2024-11-20 17:27:02,777 - ThreadPoolExecutor-40_1 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.12.3, Platform: Linux-6.8.0-48-generic-x86_64-with-glibc2.39 (connection.py:414)
2024-11-20 17:27:02,778 - ThreadPoolExecutor-40_1 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain (connection.py:1197)
2024-11-20 17:27:02,778 - ThreadPoolExecutor-40_1 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity. (connection.py:1278)
2024-11-20 17:27:03,213 - ThreadPoolExecutor-40_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP VIEW IF EXISTS "SQLMESH_DEMO"."SQLMESH_EXAMPLE"."SEED_MODEL" (base.py:2062)
2024-11-20 17:27:03,358 - ThreadPoolExecutor-40_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:27:03,370 - ThreadPoolExecutor-40_1 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:27:03,468 - ThreadPoolExecutor-40_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:27:03,484 - ThreadPoolExecutor-40_1 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:27:03,487 - ThreadPoolExecutor-40_1 - sqlmesh.core.snapshot.evaluator - INFO - Dropping view 'SQLMESH_DEMO.SQLMESH_EXAMPLE.INCREMENTAL_MODEL' (evaluator.py:1172)
2024-11-20 17:27:03,488 - ThreadPoolExecutor-40_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP VIEW IF EXISTS "SQLMESH_DEMO"."SQLMESH_EXAMPLE"."INCREMENTAL_MODEL" (base.py:2062)
2024-11-20 17:27:03,625 - ThreadPoolExecutor-40_1 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:27:03,739 - ThreadPoolExecutor-40_1 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:27:03,743 - ThreadPoolExecutor-40_0 - sqlmesh.core.snapshot.evaluator - INFO - Dropping view 'SQLMESH_DEMO.SQLMESH_EXAMPLE.FULL_MODEL' (evaluator.py:1172)
2024-11-20 17:27:03,744 - ThreadPoolExecutor-40_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP VIEW IF EXISTS "SQLMESH_DEMO"."SQLMESH_EXAMPLE"."FULL_MODEL" (base.py:2062)
2024-11-20 17:27:03,879 - ThreadPoolExecutor-40_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:27:03,997 - ThreadPoolExecutor-40_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:27:04,001 - MainThread - snowflake.connector.connection - INFO - closed (connection.py:789)
2024-11-20 17:27:04,093 - MainThread - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session (connection.py:795)
2024-11-20 17:27:04,196 - MainThread - snowflake.connector.connection - INFO - closed (connection.py:789)
2024-11-20 17:27:04,290 - MainThread - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session (connection.py:795)
2024-11-20 17:27:04,394 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Finalizing environment 'prod' (engine_adapter.py:387)
2024-11-20 17:27:04,585 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:27:05,134 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-20 17:27:05,137 - MainThread - snowflake.connector.connection - INFO - closed (connection.py:789)
2024-11-20 17:27:05,229 - MainThread - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session (connection.py:795)
2024-11-20 17:27:05,330 - MainThread - snowflake.connector.connection - INFO - closed (connection.py:789)
2024-11-20 17:27:05,430 - MainThread - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session (connection.py:795)
2024-11-20 17:27:05,542 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
