2024-11-21 15:15:04,112 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:325)
2024-11-21 15:15:04,137 - MainThread - sqlmesh.core.config.scheduler - WARNING - The snowflake engine is not recommended for storing SQLMesh state in production deployments. Please see https://sqlmesh.readthedocs.io/en/stable/guides/configuration/#state-connection for a list of recommended engines and more information. (scheduler.py:94)
2024-11-21 15:15:04,139 - MainThread - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.12.3, Platform: Linux-6.8.0-48-generic-x86_64-with-glibc2.39 (connection.py:414)
2024-11-21 15:15:04,140 - MainThread - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain (connection.py:1197)
2024-11-21 15:15:04,140 - MainThread - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity. (connection.py:1278)
2024-11-21 15:15:04,824 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 3 (cursor.py:1166)
2024-11-21 15:15:04,933 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:05,045 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:05,160 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:05,271 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 3 (cursor.py:1166)
2024-11-21 15:15:05,392 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:05,517 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:05,632 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:05,806 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 0 (cursor.py:1166)
2024-11-21 15:15:05,921 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:06,082 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 10 (cursor.py:1166)
2024-11-21 15:15:06,189 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:06,310 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 9 (cursor.py:1166)
2024-11-21 15:15:06,418 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:06,583 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:06,694 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:06,882 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:06,990 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:07,143 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:07,266 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:07,400 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:07,517 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:07,660 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 10 (cursor.py:1166)
2024-11-21 15:15:07,775 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:09,793 - ThreadPoolExecutor-10_0 - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema SQLMESH_DEMO.sqlmesh__SQL_MODELS (evaluator.py:282)
2024-11-21 15:15:09,794 - ThreadPoolExecutor-10_0 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.12.3, Platform: Linux-6.8.0-48-generic-x86_64-with-glibc2.39 (connection.py:414)
2024-11-21 15:15:09,795 - ThreadPoolExecutor-10_0 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain (connection.py:1197)
2024-11-21 15:15:09,795 - ThreadPoolExecutor-10_0 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity. (connection.py:1278)
2024-11-21 15:15:10,228 - ThreadPoolExecutor-10_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_DATABASE() (base.py:2062)
2024-11-21 15:15:10,349 - ThreadPoolExecutor-10_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:10,461 - ThreadPoolExecutor-10_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:10,463 - ThreadPoolExecutor-10_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_DATABASE() (base.py:2062)
2024-11-21 15:15:10,596 - ThreadPoolExecutor-10_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:10,703 - ThreadPoolExecutor-10_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:10,720 - ThreadPoolExecutor-10_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT DISTINCT "TABLE_CATALOG" AS "catalog", "TABLE_NAME" AS "name", "TABLE_SCHEMA" AS "schema_name", CASE WHEN "TABLE_TYPE" = 'BASE TABLE' AND "IS_DYNAMIC" = 'YES' THEN 'MANAGED_TABLE' WHEN "TABLE_TYPE" = 'BASE TABLE' THEN 'TABLE' WHEN "TABLE_TYPE" = 'TEMPORARY TABLE' THEN 'TABLE' WHEN "TABLE_TYPE" = 'LOCAL TEMPORARY' THEN 'TABLE' WHEN "TABLE_TYPE" = 'EXTERNAL TABLE' THEN 'TABLE' WHEN "TABLE_TYPE" = 'EVENT TABLE' THEN 'TABLE' WHEN "TABLE_TYPE" = 'VIEW' THEN 'VIEW' WHEN "TABLE_TYPE" = 'MATERIALIZED VIEW' THEN 'MATERIALIZED_VIEW' ELSE "TABLE_TYPE" END AS "type", "CLUSTERING_KEY" AS "clustering_key" FROM "SQLMESH_DEMO"."INFORMATION_SCHEMA"."TABLES" WHERE "TABLE_SCHEMA" = 'sqlmesh__SQL_MODELS' AND "TABLE_NAME" IN ('SQL_MODELS__JINJA_MACRO__3810123301', 'SQL_MODELS__VIEW_MODEL__704933569__temp', 'SQL_MODELS__VIEW_MODEL__704933569', 'SQL_MODELS__TESTING_MODEL__218764982__temp', 'SQL_MODELS__FULL_MODEL__1474116158', 'SQL_MODELS__TIME_RANGE_INCREMENTAL_MODEL__66652497', 'SQL_MODELS__MESH_MACRO__3030130823', 'SQL_MODELS__TESTING_MODEL__218764982', 'SQL_MODELS__SEED_MODEL__4008025669', 'SQL_MODELS__EXTERNAL_MODEL__2639882224', 'SQL_MODELS__UNIQUE_KEY_INCREMENTAL_MODEL__166104753', 'SQL_MODELS__PARTITION_INCREMENT_MODEL__1397460444') (base.py:2062)
2024-11-21 15:15:11,410 - ThreadPoolExecutor-10_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 11 (cursor.py:1166)
2024-11-21 15:15:11,545 - ThreadPoolExecutor-10_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:11,555 - MainThread - snowflake.connector.connection - INFO - closed (connection.py:789)
2024-11-21 15:15:11,654 - MainThread - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session (connection.py:795)
2024-11-21 15:15:11,784 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'SQLMESH_DEMO.sqlmesh__SQL_MODELS' (evaluator.py:906)
2024-11-21 15:15:11,785 - MainThread - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.12.3, Platform: Linux-6.8.0-48-generic-x86_64-with-glibc2.39 (connection.py:414)
2024-11-21 15:15:11,785 - MainThread - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain (connection.py:1197)
2024-11-21 15:15:11,785 - MainThread - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity. (connection.py:1278)
2024-11-21 15:15:12,274 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "SQLMESH_DEMO"."sqlmesh__SQL_MODELS" (base.py:2062)
2024-11-21 15:15:12,401 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:12,513 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:12,515 - ThreadPoolExecutor-14_0 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.12.3, Platform: Linux-6.8.0-48-generic-x86_64-with-glibc2.39 (connection.py:414)
2024-11-21 15:15:12,516 - ThreadPoolExecutor-14_0 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain (connection.py:1197)
2024-11-21 15:15:12,516 - ThreadPoolExecutor-14_0 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity. (connection.py:1278)
2024-11-21 15:15:12,976 - ThreadPoolExecutor-14_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE TABLE "SQLMESH_DEMO"."sqlmesh__SQL_MODELS"."SQL_MODELS__VIEW_MODEL__704933569__temp" (base.py:2062)
2024-11-21 15:15:13,133 - ThreadPoolExecutor-14_0 - sqlmesh.core.snapshot.evaluator - INFO - Creating view 'SQLMESH_DEMO.sqlmesh__SQL_MODELS.SQL_MODELS__VIEW_MODEL__704933569__temp' (evaluator.py:1617)
2024-11-21 15:15:13,155 - ThreadPoolExecutor-14_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE VIEW "SQLMESH_DEMO"."sqlmesh__SQL_MODELS"."SQL_MODELS__VIEW_MODEL__704933569__temp" AS SELECT "SEED_MODEL"."ID" AS "ID", "SEED_MODEL"."ITEM_ID" AS "ITEM_ID", "SEED_MODEL"."EVENT_DATE" AS "EVENT_DATE" FROM "SQLMESH_DEMO"."sqlmesh__SQL_MODELS"."SQL_MODELS__SEED_MODEL__4008025669" AS "SEED_MODEL" (base.py:2062)
2024-11-21 15:15:13,375 - ThreadPoolExecutor-14_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:13,521 - ThreadPoolExecutor-14_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:13,527 - MainThread - snowflake.connector.connection - INFO - closed (connection.py:789)
2024-11-21 15:15:13,651 - MainThread - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session (connection.py:795)
2024-11-21 15:15:13,964 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 0 (cursor.py:1166)
2024-11-21 15:15:14,132 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:14,332 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:14,474 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:15,545 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:15,854 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 9 (cursor.py:1166)
2024-11-21 15:15:15,988 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:16,172 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:16,816 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:17,589 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:17,708 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:17,833 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:17,945 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:17,946 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Promoting environment 'prod' (engine_adapter.py:266)
2024-11-21 15:15:18,136 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 11 (cursor.py:1166)
2024-11-21 15:15:18,251 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:19,097 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:19,499 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:19,649 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:20,384 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:20,707 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 14 (cursor.py:1166)
2024-11-21 15:15:20,829 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:20,985 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:21,546 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:22,321 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:22,434 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:22,614 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 2 (cursor.py:1166)
2024-11-21 15:15:22,637 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Pausing snapshot SnapshotId<"SQLMESH_DEMO"."SQL_MODELS"."VIEW_MODEL": 3776029128> (engine_adapter.py:458)
2024-11-21 15:15:22,638 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Unpausing snapshot SnapshotId<"SQLMESH_DEMO"."SQL_MODELS"."VIEW_MODEL": 1325925580> (engine_adapter.py:435)
2024-11-21 15:15:23,615 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:23,621 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'SQLMESH_DEMO.SQL_MODELS' (evaluator.py:906)
2024-11-21 15:15:23,621 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "SQLMESH_DEMO"."SQL_MODELS" (base.py:2062)
2024-11-21 15:15:23,762 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:23,878 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:23,880 - ThreadPoolExecutor-33_0 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'SQLMESH_DEMO.SQL_MODELS.VIEW_MODEL' to point at table 'SQLMESH_DEMO.sqlmesh__SQL_MODELS.SQL_MODELS__VIEW_MODEL__704933569' (evaluator.py:1162)
2024-11-21 15:15:23,882 - ThreadPoolExecutor-33_0 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.12.3, Platform: Linux-6.8.0-48-generic-x86_64-with-glibc2.39 (connection.py:414)
2024-11-21 15:15:23,882 - ThreadPoolExecutor-33_0 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain (connection.py:1197)
2024-11-21 15:15:23,882 - ThreadPoolExecutor-33_0 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity. (connection.py:1278)
2024-11-21 15:15:24,409 - ThreadPoolExecutor-33_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "SQLMESH_DEMO"."SQL_MODELS"."VIEW_MODEL" COPY GRANTS AS SELECT * FROM "SQLMESH_DEMO"."sqlmesh__SQL_MODELS"."SQL_MODELS__VIEW_MODEL__704933569" (base.py:2062)
2024-11-21 15:15:24,667 - ThreadPoolExecutor-33_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:24,776 - ThreadPoolExecutor-33_0 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:24,781 - MainThread - snowflake.connector.connection - INFO - closed (connection.py:789)
2024-11-21 15:15:24,875 - MainThread - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session (connection.py:795)
2024-11-21 15:15:24,976 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Finalizing environment 'prod' (engine_adapter.py:387)
2024-11-21 15:15:25,152 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:25,746 - MainThread - snowflake.connector.cursor - INFO - Number of results in first chunk: 1 (cursor.py:1166)
2024-11-21 15:15:25,755 - MainThread - snowflake.connector.connection - INFO - closed (connection.py:789)
2024-11-21 15:15:25,855 - MainThread - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session (connection.py:795)
2024-11-21 15:15:25,962 - MainThread - snowflake.connector.connection - INFO - closed (connection.py:789)
2024-11-21 15:15:26,076 - MainThread - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session (connection.py:795)
2024-11-21 15:15:26,184 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
